<!DOCTYPE html>
<html lang="en">
<head>
    <script>(function(s){s.dataset.zone='10545002',s.src='https://nap5k.com/tag.min.js'})([document.documentElement, document.body].filter(Boolean).pop().appendChild(document.createElement('script')))</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="monetag" content="db9dde504613de24fc3c9441de937154">
    
    <!-- Critical Resource Hints - Load First -->
    <link rel="preconnect" href="https://www.gstatic.com">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="dns-prefetch" href="//identitytoolkit.googleapis.com">
    <link rel="dns-prefetch" href="//firestore.googleapis.com">
    <link rel="dns-prefetch" href="//cdnjs.buymeacoffee.com">
    
    <title>GlitchRealm Games</title>
    
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <!-- PWA Manifest & Theming -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#00fff9">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Favicons - Optimized -->
    <link rel="icon" href="/favicon.ico" sizes="any">
    <link rel="icon" href="/assets/Favicon and Icons/favicon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" sizes="180x180" href="/assets/Favicon and Icons/apple-touch-icon.png">
    
    <!-- Preload Critical CSS -->
    <link rel="preload" as="style" href="styles.css">
    <link rel="stylesheet" href="styles.css">
    
    <!-- Preload LCP image (lazy load actual src) -->
    <link rel="preload" as="image" href="assets/game logos/ByteSurge.webp" type="image/webp">
    
    <!-- Fonts - Async Load -->
    <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600&display=swap" onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600&display=swap" rel="stylesheet">
    </noscript>
    <style>
        /* Force proper styling for profile dropdown */
        .user-profile {
            position: relative !important;
        }

        .profile-dropdown {
            position: relative !important;
        }

        .profile-trigger {
            display: flex !important;
            align-items: center !important;
            gap: 0.5rem !important;
            background: rgba(0, 255, 249, 0.1) !important;
            border: 1px solid var(--primary-cyan) !important;
            border-radius: 8px !important;
            padding: 0.5rem 0.75rem !important;
            color: var(--white) !important;
            font-family: 'Rajdhani', sans-serif !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
        }

        .profile-trigger:hover {
            background: rgba(0, 255, 249, 0.2) !important;
            box-shadow: 0 0 15px rgba(0, 255, 249, 0.3) !important;
        }

        .user-avatar {
            width: 32px !important;
            height: 32px !important;
            border-radius: 50% !important;
            border: 2px solid var(--primary-cyan) !important;
            object-fit: cover !important;
        }

        /* Avatar upload overlay styles */
        .user-avatar-container {
            position: relative !important;
            display: inline-block !important;
        }

        .avatar-upload-overlay {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0, 0, 0, 0.4) !important;
            backdrop-filter: blur(4px) !important;
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            opacity: 0 !important;
            transition: opacity 0.3s ease !important;
            cursor: pointer !important;
            z-index: 10 !important;
        }

        .user-avatar-container:hover .avatar-upload-overlay {
            opacity: 0 !important;
        }

        /* Only show upload overlay when dropdown is open */
        .profile-dropdown.active .user-avatar-container:hover .avatar-upload-overlay {
            opacity: 1 !important;
        }

        .upload-icon {
            font-size: 14px !important;
            color: rgba(255, 255, 255, 0.9) !important;
            text-shadow: 0 0 10px rgba(0, 255, 249, 0.5) !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .upload-icon svg {
            width: 16px !important;
            height: 16px !important;
            fill: currentColor !important;
        }

        .user-avatar-large-container {
            position: relative !important;
            display: inline-block !important;
        }

        .avatar-upload-overlay-large {
            position: absolute !important;
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: 100% !important;
            background: rgba(0, 0, 0, 0.5) !important;
            backdrop-filter: blur(6px) !important;
            border-radius: 50% !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            opacity: 0 !important;
            transition: opacity 0.3s ease !important;
            cursor: pointer !important;
            z-index: 10 !important;
        }

        .user-avatar-large-container:hover .avatar-upload-overlay-large {
            opacity: 0 !important;
        }

        /* Only show large upload overlay when dropdown is open */
        .profile-dropdown.active .user-avatar-large-container:hover .avatar-upload-overlay-large {
            opacity: 1 !important;
        }

        .upload-icon-large {
            font-size: 24px !important;
            color: rgba(255, 255, 255, 0.9) !important;
            text-shadow: 0 0 15px rgba(0, 255, 249, 0.7) !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
        }

        .upload-icon-large svg {
            width: 28px !important;
            height: 28px !important;
            fill: currentColor !important;
        }

        .user-name {
            font-size: 0.9rem !important;
            max-width: 120px !important;
            overflow: hidden !important;
            text-overflow: ellipsis !important;
            white-space: nowrap !important;
        }

        .dropdown-arrow {
            font-size: 0.8rem !important;
            color: var(--primary-cyan) !important;
            transition: transform 0.3s ease !important;
        }

        .profile-dropdown.open .dropdown-arrow {
            transform: rotate(180deg) !important;
        }

        .profile-menu {
            position: absolute !important;
            top: 100% !important;
            right: 0 !important;
            background: linear-gradient(135deg, #0a1629 0%, #041018 100%) !important;
            border: 2px solid var(--primary-cyan) !important;
            border-radius: 12px !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5), 0 0 20px rgba(0, 255, 249, 0.3) !important;
            min-width: 280px !important;
            max-height: 400px !important;
            overflow-y: auto !important;
            z-index: 10000 !important;
            opacity: 0 !important;
            visibility: hidden !important;
            transform: translateY(-10px) scale(0.95) !important;
            transition: all 0.3s ease !important;
            margin-top: 0.5rem !important;
        }

        .profile-dropdown.open .profile-menu {
            opacity: 1 !important;
            visibility: visible !important;
            transform: translateY(0) scale(1) !important;
        }

        .profile-info {
            padding: 1.5rem !important;
            border-bottom: 1px solid rgba(0, 255, 249, 0.2) !important;
            display: flex !important;
            align-items: center !important;
            gap: 1rem !important;
        }

        .user-avatar-large {
            width: 60px !important;
            height: 60px !important;
            border-radius: 50% !important;
            border: 3px solid var(--primary-cyan) !important;
            object-fit: cover !important;
        }

        .profile-details {
            display: flex !important;
            flex-direction: column !important;
            gap: 0.25rem !important;
        }

        .user-display-name {
            font-size: 1.1rem !important;
            font-weight: 700 !important;
            color: var(--white) !important;
        }

        .user-email {
            font-size: 0.85rem !important;
            color: var(--primary-cyan) !important;
            opacity: 0.8 !important;
        }

        .user-provider {
            font-size: 0.75rem !important;
            color: var(--primary-magenta) !important;
            text-transform: uppercase !important;
            font-weight: 600 !important;
        }

        .profile-actions {
            padding: 1rem !important;
            display: flex !important;
            flex-direction: column !important;
            gap: 0.5rem !important;
        }

        .profile-action-btn {
            display: flex !important;
            align-items: center !important;
            gap: 0.75rem !important;
            padding: 0.75rem 1rem !important;
            background: rgba(0, 0, 0, 0.3) !important;
            border: 1px solid rgba(0, 255, 249, 0.3) !important;
            border-radius: 8px !important;
            color: var(--white) !important;
            font-family: 'Rajdhani', sans-serif !important;
            font-weight: 600 !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            width: 100% !important;
            text-align: left !important;
            white-space: nowrap !important;
            overflow: visible !important;
        }

        .profile-action-btn:hover {
            background: rgba(0, 255, 249, 0.1) !important;
            border-color: var(--primary-cyan) !important;
            box-shadow: 0 0 10px rgba(0, 255, 249, 0.2) !important;
        }

        /* Ensure sign out button text is visible */
        .profile-action-btn.sign-out {
            color: var(--white) !important;
        }

        /* More specific rule for sign out button text */
        #sign-out-btn,
        #sign-out-btn *:not(.action-icon):not(.icon-svg):not(path) {
            color: var(--white) !important;
            opacity: 1 !important;
            visibility: visible !important;
        }

        .profile-action-btn.delete-account {
            border-color: rgba(255, 0, 128, 0.5) !important;
            color: var(--primary-magenta) !important;
        }

        .profile-action-btn.delete-account:hover {
            background: rgba(255, 0, 128, 0.1) !important;
            border-color: var(--primary-magenta) !important;
            box-shadow: 0 0 10px rgba(255, 0, 128, 0.2) !important;
        }

        .action-icon {
            font-size: 1.2rem !important;
        }
    </style>
    
    <!-- Unified Firebase core (loads app+auth once, sets local persistence) -->
    <script type="module" src="firebase-core.js"></script>
    <!-- Firebase SDK (page-specific usage; reuses shared app/auth if present) -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getStorage } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-storage.js';
        import { getAnalytics } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-analytics.js';
        
        const firebaseConfig = {
            apiKey: "AIzaSyCo5hr7ULHLL_0UAAst74g8ePZxkB7OHFQ",
            authDomain: "shared-sign-in.firebaseapp.com",
            projectId: "shared-sign-in",
            storageBucket: "shared-sign-in.appspot.com",
            messagingSenderId: "332039027753",
            appId: "1:332039027753:web:aa7c6877d543bb90363038",
            measurementId: "G-KK5XVVLMVN"
        };
        
        const app = window.firebaseApp || initializeApp(firebaseConfig);
        const auth = window.firebaseAuth || getAuth(app);
    // Explicitly target the default bucket using gs:// URL
    const storage = window.firebaseStorage || getStorage(app, 'gs://shared-sign-in.appspot.com');
        const analytics = getAnalytics(app);
        
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseStorage = storage;
    </script>
    
    <!-- Accessibility & Performance Enhancements -->
    <link rel="stylesheet" href="accessibility-performance.css">
    <link rel="stylesheet" href="play-now-enhancement.css">
    <script src="dev-config.js" defer></script>
    <script src="performance-optimization.js" defer></script>
    <script src="accessibility-keyboard-nav.js" defer></script>
    <script src="play-now-enhancement.js" defer></script>
</head>
<body>
    <div class="background-animation" aria-hidden="true"></div>
    
    <div id="header-placeholder"></div>

    <main class="main">
        <section class="hero">
            <div class="hero-content">
                <h1 class="hero-title">
                    <span class="glitch" data-text="Welcome to the">Welcome to the</span><br>
                    <span class="glitch-large" data-text="DIGITAL REALM">DIGITAL REALM</span>
                </h1>
                <p class="hero-tagline">Experience next-generation gaming in a cyberpunk universe</p>
                <div class="hero-buttons">
                    <a href="games.html" class="btn btn-primary glitch-btn">Play Now</a>
                    <a href="about.html" class="btn btn-secondary">Learn More</a>
                </div>
            </div>
        </section>        <main id="main-content" role="main">
        <section class="featured-game">
            <div class="container">
                <h2 class="section-title">Newest Game</h2>                
                <div class="featured-card" id="newest-game-card">
                    <div class="featured-image" id="newest-game-image">
                        <div class="game-badge new">NEW</div>
                    </div>                    
                    <div class="featured-info" id="newest-game-info">                        
                        <h3>Loading...</h3>
                        <p>Fetching the newest game from the database...</p>
                        <p class="featured-developer">Made by <strong>...</strong></p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Sign In Modal is now provided by header.html -->

    <script>
        (function(){
            function maybeRegisterCommunityIntro(){
                // If global popup scheduler is active, don’t auto-show here.
                if (window && window.GR_POPUP_SCHEDULER_ACTIVE) return;
                try {
                    const key = 'gr.community.intro.v1';
                    if (localStorage.getItem(key)) return;
                    const el = document.getElementById('community-intro');
                    if (!el) return;
                    // Fallback behavior if scheduler isn’t present: show once.
                    el.style.display = 'flex';
                    const close = document.getElementById('community-intro-close');
                    const dismiss = document.getElementById('community-intro-dismiss');
                    const open = document.getElementById('community-intro-open');
                    function hide(){ el.style.display = 'none'; }
                    close && close.addEventListener('click', hide);
                    dismiss && dismiss.addEventListener('click', hide);
                    el.addEventListener('click', (e) => { if (e.target === el) hide(); });
                    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') hide(); });
                    const setSeen = () => { try { localStorage.setItem(key, '1'); } catch(e){} };
                    dismiss && dismiss.addEventListener('click', setSeen);
                    close && close.addEventListener('click', setSeen);
                    open && open.addEventListener('click', setSeen);
                } catch (e) {}
            }
            if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', maybeRegisterCommunityIntro);
            else maybeRegisterCommunityIntro();
        })();
    </script>
    <!-- Delete Account Confirmation Modal -->
    <div id="delete-account-modal" class="auth-overlay" style="display: none;">
        <div class="auth-panel danger">
            <div class="auth-header warning">
                <div class="auth-logo">
                        <span class="glitch-constant" data-text="⚠ ACCOUNT DELETION ⚠">
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <path d="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z"/>
                        </svg>
                            ACCOUNT DELETION 
                        <svg class="icon-svg" viewBox="0 0 24 24">
                            <path d="M13 14H11V9H13M13 18H11V16H13M1 21H23L12 2L1 21Z"/>
                        </svg>
                    </span>
                </div>
            </div>
            
            <div class="auth-content">
                <div class="warning-message">
                    <p class="warning-text">This action will permanently delete your account and all associated data.</p>
                    <p class="danger-text">This operation cannot be undone.</p>
                </div>
                
                <div class="confirmation-input">
                    <div class="input-container danger">
                        <div class="input-label">Type "DELETE MY ACCOUNT" to confirm:</div>
                        <input type="text" id="delete-confirmation-input" class="neural-input danger" placeholder="DELETE MY ACCOUNT">
                        <div class="input-line danger"></div>
                    </div>
                </div>
                
                <div class="warning-actions">
                    <button id="cancel-delete" class="neural-button secondary">
                        <span class="button-text">CANCEL ACCOUNT DELETION</span>
                        <div class="button-glow"></div>
                    </button>
                    <button id="confirm-delete" class="neural-button danger">
                        <span class="button-text">DELETE ACCOUNT</span>
                        <div class="button-glow danger"></div>
                    </button>
                </div>
            </div>
            
            <div class="auth-bg-effect warning"></div>
            <div class="auth-scanlines warning"></div>        </div>
    </div>

    <div id="footer-placeholder"></div>

    <div id="auth-message" class="auth-message" style="display: none;"></div>
    <div id="auth-loading" class="auth-loading" style="display: none;">
        <div class="loading-spinner"></div>
        <span>Connecting...</span>
    </div>

    <!-- Hidden file input for profile picture upload -->
    <input type="file" id="profile-picture-upload" accept="image/*" style="display: none;">

    <!-- Profile Picture Crop Modal -->
    <div id="crop-modal" class="crop-modal" style="display: none;">
        <div class="crop-modal-content">
            <div class="crop-modal-header">
                <h3>Crop Profile Picture</h3>
                <button class="crop-modal-close" id="crop-modal-close">&times;</button>
            </div>
            <div class="crop-container">
                <div class="crop-preview-container">
                    <img id="crop-image" class="crop-image" src="" alt="Crop Preview" loading="lazy" decoding="async">
                    <div class="crop-overlay">
                        <div class="crop-circle"></div>
                    </div>
                </div>
            </div>
            <div class="crop-controls">
                <div class="zoom-control">
                    <label>Zoom:</label>
                    <input type="range" id="zoom-slider" min="1" max="3" step="0.1" value="1">
                </div>
                <div class="crop-actions">
                    <button id="crop-cancel" class="crop-btn crop-cancel">Cancel</button>
                    <button id="crop-confirm" class="crop-btn crop-confirm">Apply</button>
                </div>
            </div>
        </div>
    </div>
    </main>

    <!-- Critical: Firebase Auth (load immediately) -->
    <script src="firebase-core.js"></script>
    
    <!-- Load newest game from Firestore -->
    <script type="module">
        // Wait for Firebase to be initialized
        async function loadNewestGame() {
            // Wait for firebaseApp to be available
            if (!window.firebaseApp) {
                setTimeout(loadNewestGame, 100);
                return;
            }
            
            try {
                const { getFirestore, collection, query, where, orderBy, limit, getDocs } = await import('https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js');
                const db = getFirestore(window.firebaseApp);
                
                // Query for the newest published game
                const gamesQuery = query(
                    collection(db, 'game_submissions'),
                    where('status', '==', 'published'),
                    orderBy('createdAt', 'desc'),
                    limit(1)
                );
                
                const snapshot = await getDocs(gamesQuery);
                
                if (snapshot.empty) {
                    document.getElementById('newest-game-info').innerHTML = '<h3>No games yet</h3><p>Be the first to submit a game!</p>';
                    return;
                }
                
                const gameDoc = snapshot.docs[0];
                const game = gameDoc.data();
                const gameId = gameDoc.id;
                
                // Update the featured card
                const imageDiv = document.getElementById('newest-game-image');
                const infoDiv = document.getElementById('newest-game-info');
                const cardDiv = document.getElementById('newest-game-card');
                
                // Set background image
                if (game.coverImageUrl) {
                    imageDiv.style.backgroundImage = `url('${game.coverImageUrl}')`;
                    imageDiv.style.backgroundSize = 'cover';
                    imageDiv.style.backgroundPosition = 'center';
                }
                
                // Update info
                const ownerDisplay = game.ownerUsername || 'Community Creator';
                const detailUrl = `game-detail.html?id=${gameId}`;
                
                infoDiv.innerHTML = `
                    <h3>${game.title || 'Untitled Game'}</h3>
                    <p>${game.description || 'No description available.'}</p>
                    <p class="featured-developer">Made by <strong>${ownerDisplay}</strong></p>
                    <a href="${detailUrl}" class="play-btn" style="margin-top: 18px; display: inline-flex; align-items: center; gap: 8px; padding: 10px 20px; text-decoration: none; font-family: 'Rajdhani', sans-serif; font-weight: 600; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 0.5px; color: var(--primary-cyan); border: 1px solid var(--primary-cyan); border-radius: 9px; transition: all 0.2s ease;">
                        <svg width="10" height="12" viewBox="0 0 10 12" fill="currentColor" style="flex-shrink: 0;">
                            <polygon points="0,0 10,6 0,12"/>
                        </svg>
                        <span>Play Now</span>
                    </a>
                `;
                
                // Add hover effect via JavaScript
                const playBtn = infoDiv.querySelector('.play-btn');
                
                playBtn.addEventListener('mouseenter', function() {
                    this.style.backgroundColor = 'var(--primary-cyan)';
                    this.style.color = '#0a0a0a';
                });
                
                playBtn.addEventListener('mouseleave', function() {
                    this.style.backgroundColor = 'transparent';
                    this.style.color = 'var(--primary-cyan)';
                });
                
                // Make card clickable
                cardDiv.style.cursor = 'pointer';
                cardDiv.addEventListener('click', (e) => {
                    // Don't navigate if clicking the button
                    if (!e.target.closest('.neural-button')) {
                        window.location.href = `game-detail.html?id=${gameId}`;
                    }
                });
                
            } catch (err) {
                console.error('Error loading newest game:', err);
                document.getElementById('newest-game-info').innerHTML = '<h3>Error loading game</h3><p>Please refresh the page.</p>';
            }
        }
        
        // Start loading when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', loadNewestGame);
        } else {
            loadNewestGame();
        }
    </script>
    
    <!-- Glitch Effect Settings Modal -->
    <div id="glitchSettingsModal" class="glitch-settings-overlay">
        <div class="glitch-settings-modal">
            <div class="glitch-settings-header">
                <h2>⚡ Glitch Effect Settings</h2>
                <button class="glitch-close-btn" onclick="closeGlitchSettings()">&times;</button>
            </div>
            <div class="glitch-settings-body">
                <div class="glitch-preview-section">
                    <h3>Preview</h3>
                    <div class="glitch-preview-text">
                        <span class="glitch glitch-preview" data-text="GlitchRealm">GlitchRealm</span>
                    </div>
                </div>
                <div class="glitch-options-section">
                    <h3>Animation Speed</h3>
                    <div class="glitch-radio-group">
                        <label class="glitch-radio-label">
                            <input type="radio" name="glitchSpeed" value="stopped" />
                            <span class="glitch-radio-custom"></span>
                            <span class="glitch-radio-text">Stopped (No Animation)</span>
                        </label>
                        <label class="glitch-radio-label">
                            <input type="radio" name="glitchSpeed" value="slow" />
                            <span class="glitch-radio-custom"></span>
                            <span class="glitch-radio-text">Slow</span>
                        </label>
                        <label class="glitch-radio-label">
                            <input type="radio" name="glitchSpeed" value="fast" checked />
                            <span class="glitch-radio-custom"></span>
                            <span class="glitch-radio-text">Fast (Default)</span>
                        </label>
                    </div>
                </div>
                <button class="glitch-save-btn" onclick="saveGlitchSettings()">Save Settings</button>
            </div>
        </div>
    </div>

    <!-- Deferred: Non-critical scripts -->
    <script src="image-loader.js" defer></script>
    <script src="script.js" defer></script>
    <script src="glitch-settings.js" defer></script>
    <script type="module" src="header-avatar-integration.js"></script>
    
    <!-- Lazy: Game launcher (only load on interaction) -->
    <script src="game-launcher-lazy.js" defer></script>
    
    <!-- Very Low Priority: Icons and widgets -->
    <script src="https://cdn.jsdelivr.net/npm/devicon@latest/devicon.min.js" defer></script>
</body>
<script>
/* BMC widget lazy loader: prevents main-thread jank while keeping same visuals */
(function(){
    const cfg = {src:'https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js',id:'glitchrealmdevs',desc:'Support me on Buy me a coffee!',msg:'Contribute to the development of GlitchRealm.',color:'#5F7FFF',pos:'Right',x:'18',y:'18'};
    function inject(){
        if(document.getElementById('bmc-widget-script')) return;
        const s=document.createElement('script');
        s.id='bmc-widget-script';
        s.src=cfg.src; s.dataset.name='BMC-Widget'; s.setAttribute('data-cfasync','false');
        s.setAttribute('data-id',cfg.id); s.setAttribute('data-description',cfg.desc); s.setAttribute('data-message',cfg.msg);
        s.setAttribute('data-color',cfg.color); s.setAttribute('data-position',cfg.pos);
        s.setAttribute('data-x_margin',cfg.x); s.setAttribute('data-y_margin',cfg.y);
        document.body.appendChild(s);
    }
    if(window.requestIdleCallback) requestIdleCallback(inject,{timeout:2500});
    else window.addEventListener('load',()=>setTimeout(inject,600));
    ['pointerdown','keydown','scroll'].forEach(evt=>window.addEventListener(evt,inject,{once:true,passive:true}));
})();
</script>
</html>
