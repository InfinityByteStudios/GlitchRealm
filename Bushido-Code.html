<!doctype html>
<!--
  Bushido Code Interactive Guide
  Single-file HTML, CSS, and JavaScript page.
  - Teaches the seven virtues of Bushido
  - Each virtue button shows: definition, historical samurai example, modern-day example
  - Styled with soft beige, red, and black tones, rounded corners, and smooth transitions
  - All code is inline and commented for clarity
-->
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Bushido Code Interactive Guide</title>
      <!-- Favicon: uses the provided Supabase-hosted PNG -->
      <link rel="icon" type="image/png" href="https://hkogcnxmrrkxggwcrqyh.supabase.co/storage/v1/object/public/GlitchRealm/Bushido%20Coding%20Favicon.png">
      <!-- Optional: theme color for some browsers/tasks -->
      <meta name="theme-color" content="#b22222">
    <style>
      /* Palette: soft beige background, warm red accents, deep black text */
      :root{
        --beige:#f2e9df;
        --accent:#b22222; /* firebrick red */
        --muted:#7a5a4f; /* brownish muted tone for contrast */
        --black:#0b0b0b;
        --card:#fffaf6;
        --radius:12px;
        --transition:300ms cubic-bezier(.2,.9,.2,1);
      }

      /* Basic layout and typography */
      html,body{height:100%;}
      body{
        margin:0; padding:28px; background:linear-gradient(180deg,var(--beige),#efe6db 60%);
        font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
        color:var(--black); -webkit-font-smoothing:antialiased;
      }

      .wrap{max-width:980px;margin:0 auto}
      header{display:flex;align-items:center;gap:18px;margin-bottom:18px}
  .logo{width:68px;height:68px;border-radius:12px;background:var(--card);display:flex;align-items:center;justify-content:center;border:2px solid rgba(0,0,0,0.06);box-shadow:0 6px 18px rgba(0,0,0,0.06);overflow:hidden}
  .logo img{width:100%;height:100%;object-fit:cover;display:block}
      h1{font-size:1.6rem;margin:0}
      p.lead{margin:6px 0 0;color:var(--muted)}

      /* Grid for buttons + display area */
      .grid{display:grid;grid-template-columns:320px 1fr;gap:18px;align-items:start}

      /* Buttons column */
      .virtues{background:var(--card);padding:14px;border-radius:var(--radius);box-shadow:0 6px 20px rgba(0,0,0,0.06);border:1px solid rgba(0,0,0,0.04)}
      .virtues h2{margin:0 0 8px;font-size:1.05rem}
      .btn-list{display:flex;flex-direction:column;gap:8px}
      .virt-btn{
        display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:linear-gradient(180deg,#fff,#fffaf6);
        cursor:pointer;transition:transform var(--transition), box-shadow var(--transition), background var(--transition);
      }
      .virt-btn:hover{transform:translateY(-4px);box-shadow:0 10px 30px rgba(0,0,0,0.08)}
      .virt-btn.active{background:linear-gradient(180deg,#fff6f6,#fff0ef);border-color:rgba(178,34,34,0.2);box-shadow:0 14px 36px rgba(178,34,34,0.06)}
  /* Make sure kanji render nicely by preferring Japanese-capable fonts here */
  .virt-symbol{width:56px;height:56px;border-radius:8px;background:var(--accent);color:white;display:flex;align-items:center;justify-content:center;font-weight:700;box-shadow:0 6px 14px rgba(178,34,34,0.12);font-size:22px;line-height:1;font-family: 'Meiryo','Yu Gothic','Noto Sans JP', system-ui, sans-serif}
    /* Nice-looking fun-fact button styles. Left-column small fun buttons removed; only the in-panel button remains.
      .fun-btn is the base, .fun-btn.primary is used for the main in-panel button */
  /* base fun button (no fixed width so primary variant can size naturally) */
  .fun-btn{border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:linear-gradient(180deg,#fff,#fffaf6);cursor:pointer;display:inline-flex;align-items:center;justify-content:center;font-size:18px;transition:transform var(--transition),box-shadow var(--transition);padding:6px}
    .fun-btn:hover{transform:translateY(-3px);box-shadow:0 10px 20px rgba(0,0,0,0.06)}
    .fun-btn:focus{outline:3px solid rgba(178,34,34,0.12);outline-offset:3px}
    .fun-btn.primary{padding:10px 14px;border-radius:10px;background:linear-gradient(180deg,var(--accent),#a31818);color:white;border:0;box-shadow:0 12px 30px rgba(178,34,34,0.18);font-weight:600;display:inline-flex;align-items:center;gap:8px}
    .fun-btn.primary .fun-icon{font-size:18px}
  /* Ensure the in-panel Fun fact button text is centered (override inline span margin) */
  #virtFunBtn { justify-content: center; }
  #virtFunBtn > span { margin-left: 0 !important; display:inline-block; width:100%; text-align:center; }
  /* modal popup for Fun Facts */
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:none;align-items:center;justify-content:center;padding:20px;z-index:40}
  .modal-backdrop.show{display:flex}
  .modal{background:var(--card);padding:18px;border-radius:12px;max-width:720px;width:100%;box-shadow:0 20px 60px rgba(0,0,0,0.25);border:1px solid rgba(0,0,0,0.06);position:relative}
  .modal h4{margin:0 0 8px;color:var(--accent)}
  .modal .modal-body{color:var(--muted)}
  .modal .modal-close{position:absolute;right:18px;top:14px;background:transparent;border:0;font-size:20px;cursor:pointer}
      .virt-meta{display:flex;flex-direction:column}
      .virt-meta small{color:var(--muted)}

      /* Display panel */
      .panel{background:var(--card);padding:18px;border-radius:var(--radius);min-height:220px;border:1px solid rgba(0,0,0,0.04);box-shadow:0 8px 30px rgba(0,0,0,0.06);transition:transform var(--transition),opacity var(--transition)}
        /* track which virtue button is currently active (selected) -- JS variable moved to script */
      .panel .section{margin-top:12px}
      .section-title{font-weight:600;color:var(--muted);font-size:0.9rem}
      .example{margin-top:6px;background:rgba(11,11,11,0.02);padding:10px;border-radius:8px}

      /* Small screens: stack columns */
      @media (max-width:820px){
        .grid{grid-template-columns:1fr;}
      }

      /* subtle focus outline for accessibility */
      .virt-btn:focus{outline:3px solid rgba(178,34,34,0.12);outline-offset:3px}
    </style>
  </head>
  <body>
    <div class="wrap">
      <!-- Header: title and short description -->
      <header>
        <!-- Replace emoji with the favicon image for a polished logo
             Uses the same Supabase-hosted PNG referenced in the head as the favicon -->
        <div class="logo" aria-hidden="true">
          <img src="https://hkogcnxmrrkxggwcrqyh.supabase.co/storage/v1/object/public/GlitchRealm/Bushido%20Coding%20Favicon.png" alt="Bushido logo" />
        </div>
        <div>
          <h1>Bushido Code Interactive Guide</h1>
          <p class="lead">Explore the seven virtues of Bushido. Click a virtue to learn its meaning, a historical samurai example, and a modern-day application.</p>
        </div>
      </header>

      <!-- Main grid: left column for virtue buttons, right column for content display -->
      <div class="grid" role="region" aria-label="Bushido virtues">
        <aside class="virtues" aria-label="Virtues list">
          <h2>Seven virtues</h2>
          <div class="btn-list" id="btnList">
            <!-- Buttons are generated by JavaScript. Each button contains a short symbol and label. -->
          </div>
        </aside>

        <!-- Display panel: definition, historical example, modern example -->
        <main class="panel" id="display" aria-live="polite">
          <h3 id="virtTitle">Select a virtue</h3>
          <div class="section">
            <div class="section-title">Definition</div>
            <div id="virtDef" class="example">Click a virtue on the left to see what it means and examples.</div>
          </div>
          <div class="section">
            <div class="section-title">Historical samurai example</div>
            <div id="virtHist" class="example"></div>
          </div>
          <div class="section">
            <div class="section-title">Modern-day example</div>
            <div id="virtModern" class="example"></div>
            <!-- Fun Fact button placed under the modern example; opens a modal popup -->
              <div style="margin-top:10px;display:flex;flex-direction:column;align-items:center;">
                <button id="virtFunBtn" class="fun-btn primary" type="button"><span style="margin-left:6px">Fun Fact</span></button>
                <!-- small hint on top, visible before first click -->
                <div id="virtFunSmallHint" style="margin-top:6px;font-size:12px;color:var(--muted);text-align:center">Click me</div>
                <div id="virtFunHint" style="margin-top:6px;font-size:12px;color:var(--muted);text-align:center">After you click the button for the first time, this hint will disappear.</div>
              </div>
          </div>
        </main>
      </div>
      <!-- Footnote explaining the asterisk on the virtue labels -->
      <div style="text-align:center;font-size:12px;color:var(--muted);margin-top:12px">* Learned from research.</div>
    </div>

    <script>
      /*
        Data: the seven virtues with definition, historical example, and modern example.
        Note: Historical examples are brief, commonly cited figures or incidents used for educational purposes.
      */
      const virtues = [
        {
          id: 'gi', short: 'Gi', kanji: '義', name: 'Gi — Rectitude*',
          definition: 'Gi (Rectitude) signifies making morally correct choices and acting with fairness and integrity.',
          historical: 'Kusunoki Masashige is remembered for staying loyal to his principles even under extreme pressure.',
          modern: 'A public official who resists corruption and makes impartial decisions shows rectitude today.',
          funFact: 'The kanji 義 combines elements that once suggested a person and an animal; over time it came to represent righteousness.'
        },
        {
          id: 'yu', short: 'Yu', kanji: '勇', name: 'Yu — Courage*',
          definition: 'Yu (Courage) describes showing bravery when facing danger or hard choices, not just physical daring but moral resolve.',
          historical: 'Miyamoto Musashi became famous for his fearless duels and strategic skill in combat.',
          modern: 'Emergency responders who enter dangerous situations to help others exemplify courage today.',
          funFact: 'The kanji 勇 historically suggested moving forward boldly; it evokes decisive action.'
        },
        {
          id: 'jin', short: 'Jin', kanji: '仁', name: 'Jin — Benevolence*',
          definition: 'Jin (Benevolence) involves kindness, compassion, and helping others with sincere concern.',
          historical: 'Uesugi Kenshin earned a reputation for generosity and fair treatment of people during times of conflict.',
          modern: 'Volunteers and social workers who support communities demonstrate benevolence today.',
          funFact: 'The kanji 仁 shows a person next to another person, symbolizing empathy and human connection.'
        },
        {
          id: 'rei', short: 'Rei', kanji: '礼', name: 'Rei — Respect*',
          definition: 'Rei (Respect) emphasizes courteous behavior, proper etiquette, and valuing others’ dignity.',
          historical: 'Samurai observed formal bows and strict manners to maintain social order and discipline.',
          modern: 'People who listen carefully, use polite language, and honour commitments show respect today.',
          funFact: '礼 originally referred to formal rituals and bowing; it continues to represent courtesy and decorum.',
          personalFunFact: 'I practice Aikido: at the start of class the most senior student says "Rei" (礼) as we bow. It means "respect" and shows honor, discipline, and proper etiquette.'
        },
        {
          id: 'makoto', short: 'Makoto', kanji: '誠', name: 'Makoto — Honesty*',
          definition: 'Makoto (Honesty) means telling the truth, keeping promises, and acting with sincere intent.',
          historical: 'Many samurai tales honour those who accepted responsibility and remained truthful in hard times.',
          modern: 'Journalists and auditors who present accurate facts and admit errors model honesty today.',
          funFact: 'The kanji 誠 contains a speech element, connecting honest action with truthful words.'
        },
        {
          id: 'meiyo', short: 'Meiyo', kanji: '名誉', name: 'Meiyo — Honor*',
          definition: 'Meiyo (Honor) refers to reputation earned through dignified actions and moral conduct.',
          historical: 'The tale of the 47 Rōnin highlights how the pursuit of honor shaped difficult, sometimes tragic choices.',
          modern: 'Someone who takes responsibility to preserve trust and dignity demonstrates honor today.',
          funFact: '名誉 pairs characters for "name" and "esteem", illustrating how honor relates to one’s social standing.'
        },
        {
          id: 'chugi', short: 'Chūgi', kanji: '忠義', name: 'Chūgi — Loyalty*',
          definition: 'Chūgi (Loyalty) means faithful support for family, friends, or leaders, even during challenges.',
          historical: 'Many samurai maintained steadfast loyalty to their lords in times of hardship and conflict.',
          modern: 'A colleague who supports their team through difficulties is an example of loyalty today.',
          funFact: '忠義 combines characters for devotion and righteousness; it frequently appears in samurai texts.'
        }
      ];
  // track which virtue button is currently active (selected)
  let activeBtn = null;
  // will hold references to the display elements once the DOM is ready
  let display = null;
      function createButton(v){
        // Create only the main virtue button (text-only changes allowed)
        const btn = document.createElement('button');
        btn.className = 'virt-btn';
        btn.type = 'button';
        btn.setAttribute('data-id', v.id);
        btn.setAttribute('aria-pressed', 'false');
        // Show the kanji as the prominent symbol and keep the romaji/name in the metadata
        btn.innerHTML = `
          <div class="virt-symbol" aria-hidden="true">${v.kanji}</div>
          <div class="virt-meta"><strong>${v.name}</strong><small>${v.short}   ${v.definition.slice(0,70)}...</small></div>
        `;

        // clicking the main button selects the virtue
        btn.addEventListener('click', () => selectVirtue(v, btn));
        btn.addEventListener('keydown', (e) => {
          if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); btn.click(); }
        });

        return btn;
      }

      function selectVirtue(v, btn){
        // Update active style
        if(activeBtn) {
          activeBtn.classList.remove('active');
          activeBtn.setAttribute('aria-pressed','false');
        }
        btn.classList.add('active');
        btn.setAttribute('aria-pressed','true');
        activeBtn = btn;

        // Smoothly update display content
        display.title.style.opacity = 0.0; display.def.style.opacity = 0.0; display.hist.style.opacity = 0.0; display.modern.style.opacity = 0.0;
        setTimeout(()=>{
          // Include the kanji prominently next to the title
          display.title.innerHTML = `${v.name} <span style="font-size:1.15rem;margin-left:10px;color:var(--muted);font-family:'Meiryo','Noto Sans JP',sans-serif">${v.kanji}</span>`;
          display.def.textContent = v.definition;
          display.hist.textContent = v.historical;
          display.modern.textContent = v.modern;
          display.title.style.opacity = 1; display.def.style.opacity = 1; display.hist.style.opacity = 1; display.modern.style.opacity = 1;

          // set the in-panel Fun Fact button to open the modal for this virtue
          const inPanelBtn = document.getElementById('virtFunBtn');
          if(inPanelBtn){
            // Pass the entire virtue object so the modal can show both the main funFact and a personalFunFact section
            inPanelBtn.onclick = (e) => {
              e.preventDefault();
              // hide the hints the first time the button is clicked
              const hint = document.getElementById('virtFunHint');
              if(hint) hint.style.display = 'none';
              const small = document.getElementById('virtFunSmallHint');
              if(small) small.style.display = 'none';
              openModal(v);
            };
            inPanelBtn.onkeydown = (e) => { if(e.key === 'Enter' || e.key === ' '){ e.preventDefault(); const hint = document.getElementById('virtFunHint'); if(hint) hint.style.display = 'none'; const small = document.getElementById('virtFunSmallHint'); if(small) small.style.display = 'none'; openModal(v); } };
            inPanelBtn.style.visibility = v.funFact ? 'visible' : 'hidden';
            inPanelBtn.title = v.funFact ? `Fun Fact about ${v.short}` : 'No Fun Fact available';
          }
        }, 180);
      }
      
      // Modal: open and close functions. openModal accepts either a string (legacy) or a virtue object
      function openModal(vOrText){
        let backdrop = document.getElementById('modalBackdrop');
        let modalText = document.getElementById('modalText');
        if(!backdrop){
          // create modal elements on demand (in case HTML was not present)
          backdrop = document.createElement('div');
          backdrop.id = 'modalBackdrop';
          backdrop.className = 'modal-backdrop';
          backdrop.innerHTML = `
            <div class="modal" role="dialog" aria-modal="true">
              <button class="modal-close" aria-label="Close">×</button>
              <h4>Fun Fact</h4>
              <div class="modal-body" id="modalText"></div>
            </div>`;
          document.body.appendChild(backdrop);
          backdrop.querySelector('.modal-close').addEventListener('click', closeModal);
          backdrop.addEventListener('click', (e) => { if(e.target === backdrop) closeModal(); });
          document.addEventListener('keydown', (e) => { if(e.key === 'Escape') closeModal(); });
          modalText = document.getElementById('modalText');
        }

        if(typeof vOrText === 'object' && vOrText !== null){
          const main = vOrText.funFact || 'No Fun Fact available.';
          const personal = vOrText.personalFunFact;
          let html = `<p>${escapeHtml(main)}</p>`;
          if(personal){
            html += `<hr style="border:none;border-top:1px solid rgba(0,0,0,0.06);margin:10px 0">`;
            html += `<div style="font-weight:700;margin-bottom:6px">Personal Fun Fact</div>`;
            html += `<p style="margin:0">${escapeHtml(personal)}</p>`;
          }
          modalText.innerHTML = html;
        } else {
          modalText.textContent = String(vOrText || 'No Fun Fact available.');
        }

        backdrop.classList.add('show');
        backdrop.setAttribute('aria-hidden','false');
      }

      function closeModal(){
        const backdrop = document.getElementById('modalBackdrop');
        if(backdrop){ backdrop.classList.remove('show'); backdrop.setAttribute('aria-hidden','true'); }
      }

      function escapeHtml(str){
        return String(str).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;');
      }

      // Wait for DOM so we can safely query elements and populate buttons
      window.addEventListener('DOMContentLoaded', ()=>{
        const btnList = document.getElementById('btnList');
        // Populate the left column with virtue buttons
        virtues.forEach(v => btnList.appendChild(createButton(v)));

        // Cache the display area elements for use by selectVirtue
        display = {
          title: document.getElementById('virtTitle'),
          def: document.getElementById('virtDef'),
          hist: document.getElementById('virtHist'),
          modern: document.getElementById('virtModern')
        };

        // Optionally select the first virtue on load
        const firstBtn = btnList.querySelector('button');
        if(firstBtn) firstBtn.click();
      });

      /*
        Future enhancements (notes for maintainers/users):
        - Add localStorage autosave for user notes on each virtue
        - Add print-friendly styles
        - Add expandable "learn more" sections with sources/references
      */
    </script>
  </body>
</html>
